---
id: usecase-geoeconomics
title: Use case: Worldbank and GeoNames
---

Generate the worldbank and GeoNames dataset:

```shell
d2s generate dataset
```

> Fill in the right metadata.

The folder with the RML mappings, metadata and download files are generated in `datasets/worldbank` and `datasets/geonames`

## Define download files

Define a simple bash script to download WorldBank XML from its GitHub URL in `datasets/worldbank/download/download.sh`:

```shell
#!/bin/bash
## Download XML file from GitHub
wget -N https://raw.githubusercontent.com/MaastrichtU-IDS/UM_KEN4256_KnowledgeGraphs/master/dataset-worldbank-gdp-full.xml
wget -N https://raw.githubusercontent.com/MaastrichtU-IDS/UM_KEN4256_KnowledgeGraphs/master/dataset-worldbank-gdp.xml
```

Same for GeoNames:

```shell
#!/bin/bash
## Download TSV file from GitHub
wget -N https://raw.githubusercontent.com/MaastrichtU-IDS/UM_KEN4256_KnowledgeGraphs/master/dataset-geonames-countryInfo.csv
```

## Improve metadata

We improved the metadata for GeoNames and WorldBank datasets by editing those files:

* `datasets/worldbank/metadata/metadata-template-0-summary.rq`
* `datasets/worldbank/metadata/metadata-template-1.rq`
* `datasets/geonames/metadata/metadata-template-0-summary.rq`
* `datasets/geonames/metadata/metadata-template-1.rq`

> To edit metadata such as keywords, theme, homepage, download URL, etc.

## Define RML mapping files

Some templates mapping files are generated when creating a new dataset to help start mappings different king of file. Delete them and define mapping files for WorldBank and geoName

* WorldBank mappings in [datasets/worldbank/mapping/gdp_mapping.rml.ttl](https://github.com/MaastrichtU-IDS/d2s-transform-template/blob/master/datasets/worldbank/mapping/gdp_mapping.rml.ttl)

* GeoName mappings in [datasets/geonames/mapping/country_mapping.rml.ttl](https://github.com/MaastrichtU-IDS/d2s-transform-template/blob/master/datasets/geonames/mapping/country_mapping.rml.ttl)

* Additional mapping file to map WorldBank and GeoNames using ISO2 and ISO3 code correspondance in [datasets/geonames/mapping/iso_mapping.rml.ttl](https://github.com/MaastrichtU-IDS/d2s-transform-template/blob/master/datasets/geonames/mapping/iso_mapping.rml.ttl)

## Download input files

Use the `d2s` tool to download datasets files defined in their respective `download.sh` file:

```shell
d2s download worldbank
d2s download geonames
```

Here is a sample of the CSV file used to map ISO2 and ISO3:

```
ISO,ISO3
AD,AND
AE,ARE
```

## Run the RMLMapper

Fix input file permissions:

```shell
sudo chmod -R 777 workspace/input 
```

Start the data transformation

```shell
d2s rml worldbank --mapper
d2s rml geonames --mapper --watch 
```

> See running jobs at http://localhost:8078

> The `RMLStreamer` can also be used, it is faster and more scalable, but its development is not has advanced as the rmlmapper and you might face issues with RML conversion:
>
> ```shell
> d2s start rmlstreamer rmltask
> d2s rml worldbank --streamer --watch
> d2s rml geonames --streamer --watch
> ```

Ntriple files generated in `workspace/import`

## Load the generated triples

Start Ontotext GraphDB triplestore locally.

This can be done using `d2s` if you previously downloaded and set the GraphDB installation file.

```shell
d2s start graphdb
```

* Go to http://localhost:7200
  * Create a repository (e.g. `geoeconomics`). Enable `Use context index`.

* The files generated by the RML mapper should be available at http://localhost:7200/import#server
  * For the KG course we would have load the ntriples generated by the RML mappings for GeoNames and WorldBank in the "Named graph" http://kg-course/mapping
  * But in this use case we will load WorldBank and GeoNames data in separated graphs to be able to compute metadata about them.
    * https://w3id.org/d2s/graph/worldbank
    * https://w3id.org/d2s/graph/geonames
  * Load the ntriples generated by the ISO mappings in the Named graph http://kg-course/interlinking

## Optional: compute and load metadata

Edit the config.yml to define the parameters of the workflow that will compute metadata for the dataset

* sparql_final_graph_uri: your graph
  * e.g. https://w3id.org/d2s/graph/geonames

* sparql_final_triplestore_url: SPARQL endpoint to compute and load the RDF 
  * e.g. http://graphdb:7200/repositories/geoeconomics/statements
* sparql_final_triplestore_username
  * e.g. admin
* sparql_final_triplestore_password
  * e.g. password